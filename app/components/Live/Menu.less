// Constants prefixed with js *must* be the same in JavaScript.
@js__margin__menuChild: 10px;
@js__margin__menuChild__narrow: 3px;
@js__height__menu: 72px;

/**
 * Needed by JavaScript to calculate scores tips in main breakpoints.
 */
@js__maxWidth__childAudio: 640px; // Arbitrary.
@js__minWidth__childTitle: 72px; // Arbitrary.

@maxWidth__childTitle: 200px; // Arbitrary.

// This works out to 50px;
@js__height__menuTopRow__phone:
    @js__length__icon +
    @js__margin__menuChild__narrow * 2;

// Arbitrary for now.
@js__height__audio: 66px;
@js__height__audioBanner__bottomRow: @js__height__audio / 2;
@js__height__audioSlider__bottomRow: @js__height__audio / 2;

// Two row menu in mini. Includes menu and slider.
@js__height__aboveOverlay__twoRowMenu:
    @js__height__menu +
    @js__height__audioSlider__bottomRow;

// Two row menu in mini. Includes menu, banner, and slider.
@js__height__menu__twoRowMenu:
    @js__height__aboveOverlay__twoRowMenu +
    @js__height__audioBanner__bottomRow;

// Phone always has two rows in menu. Includes menu and slider.
@js__height__aboveOverlay__phone:
    @js__height__menuTopRow__phone +
    @js__height__audioSlider__bottomRow;

// Phone always has two rows in menu. Includes menu, banner, and slider.
@js__height__menu__phone:
    @js__height__aboveOverlay__phone +
    @js__height__audioBanner__bottomRow;

@height__bottomRow:
    @js__height__audioBanner__bottomRow +
    @js__height__audioSlider__bottomRow;

.Menu {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: @js__height__menu;

    .RM__twoRowMenu
    & {
        height: @js__height__menu__twoRowMenu;
    }

    .RM__phone
    & {
        height: @js__height__menu__phone;
    }
}

.MenuRow {
    z-index: @zIndex__menuField;
}

.MenuTopRow {
    position: relative;
    height: 100%;

    overflow: hidden;

    background-color: #8dd;

    transform: translateX(0);

    transition:
        margin @animationDuration__slow,
        max-width @animationDuration__slow;

    .RM__overlayHidden
    & {
        /**
         * When overlay is hidden, override the dynamic margins calculated by
         * JavaScript. Not happy about doing this, but I wasn't able to keep
         * the animation smooth in Safari any other way.
         */
        margin: 0 !important;
    }

    .RM__overlayShown
    &.width__mainColumn {
        max-width: @js__width__mini;
    }

    .RM__twoRowMenu
    & {
        height: @js__height__menu;
    }

    .RM__phone
    & {
        height: @js__height__menuTopRow__phone;
    }

    .RM__scoresTipsMain
    & {
        justify-content: space-between;
    }
}

.MenuTopRow,
.MenuRowChild__scoresTips {
    display: flex;
    align-items: center;
}

.MenuRowChild {
    height: 100%;

    transition:
        min-width @animationDuration__fast,
        max-width @animationDuration__fast;
}

.MenuRowChild__title {
    position: relative;

    flex-grow: 1;

    min-width: @js__minWidth__childTitle;
    max-width: @maxWidth__childTitle;

    .RM__twoRowMenu
    & {
        /**
         * Don't bother to show if title in audio. Child component also will
         * not be rendered.
         */
        display: none;
    }
}

.MenuRowChild__audio {
    // Audio should shrink at a slower rate than title.
    flex-grow: 10;

    min-width: @js__maxWidth__childAudio;
    max-width: @js__maxWidth__childAudio;

    transition: margin @animationDuration__default;

    background-color: #8d8;

    // Applies to monitor and tablet.
    margin: 0 @js__margin__menuChild;

    .RM__laptop
    &,
    .RM__mini
    & {
        margin: 0 @js__margin__menuChild__narrow;
    }

    .RM__scoresTipsMain
    & {
        // If scores tips is hidden, remove audio subfield's right margin.
        margin-right: 0;

        min-width:
            @js__minWidth__audioBanner
            + @minWidth__audioButtons__minusPlayer
            + @js__length__iconLarge
            + @js__padding__audio * 3;
    }

    .RM__twoRowMenu
    & {
        // If title is hidden, remove audio subfield's left margin.
        margin-left: 0;
    }

    .RM__mobile
    & {
        justify-content: flex-end;
    }

    // box-sizing: border-box;

    .RM__tablet.RM__scoresTipsMain
    & {
        min-width:
        @js__minWidth__audioBanner
        + @minWidth__audioButtons__minusPlayer
        + @js__length__iconLarge__tablet
        + @js__padding__audio * 3;
    }

    .RM__mini.RM__twoRowMenu
    & {
        min-width:
        @js__minWidth__audioBanner
        + @minWidth__audioButtons__minusPlayer
        + @js__length__iconLarge__mini
        + @js__padding__audio * 3;
    }

    .RM__mini.RM__oneRowMenu
    & {
        min-width:
        @minWidth__audioButtons__minusPlayer
        + @js__length__iconLarge__mini
        + @js__padding__audio * 3;
    }

    .RM__phone
    & {
        min-width:
        @minWidth__audioButtons__minusPlayer
        + @js__length__icon
        + @js__padding__audio * 3;
    }

    .RM__overlayShown
    & {
        max-width: 100%;
        margin-right: 0;
    }

    .RM__overlayShown:not(.RM__phone)
    & {
        margin-left: 0;
    }
}

.MenuRowChild__scoresTips {

    .RM__scoresTipsMain
    & {
        /**
         * Don't bother to show if scores tips in main. Child component also
         * will not be rendered.
         */
        display: none;
    }

    min-width: @width__childScoresTips;

    .RM__tablet
    & {
        min-width: @width__childScoresTips__tablet;
    }

    .RM__mini
    & {
        min-width: @width__childScoresTips__mini;
    }
}

.widths__hiddenInOverlay {

    .RM__overlayShown
    & {
        width: 0;
        min-width: 0;
        max-width: 0;
    }
}

.MenuBottomRow {
    position: absolute;
    bottom: 0;
    height: @height__bottomRow;

    transition: bottom @animationDuration__default;

    .RM__overlayShown
    &,
    .RM__song.RM__lyricExpanded
    & {
        bottom: @js__height__audioBanner__bottomRow;
    }
}