@dot-container-diameter: 64px;
@dot-container-padding: @dot-container-diameter / 6;

@dot-container-phone-diameter: @app-large-icon-diameter * 0.95;
@dot-container-phone-padding: @app-large-icon-diameter / 7;

@dot-border: 1px;

.dots-block {
    .dot-diameter-mixin;
    display: flex;
    width: auto;
    height: 100%;
}

.anchor-block {
    .dot {
        transition: width 0.15s, transform 0.15s;

        &.is-present {
            transform: scale(1);
        }

        &.is-absent {
            transform: scale(0);
            width: 0;
        }
    }
}

// Undo reverse dot order caused by right column's rtl direction.
.right {
    .dots-block {
        flex-direction: row-reverse;
    }
}

.dots-subfield {
    .dot-diameter-mixin(@dot-container-diameter, 0);

    .dots-block {
        display: flex;
        justify-content: center;
        flex-wrap: wrap;

        // Monitor through mini will have four dots per row.
        // FIXME: Not sure why 3 is the minimum multiplier for border...?
        width: 4 * (@dot-container-diameter + 2 * @dot-container-padding + 3 * @dot-border);
    }

    .dot-container {
        display: flex;
        flex-direction: column-reverse;
        padding: @dot-container-padding;
        box-sizing: border-box;
    }
}

.dots-section {
    padding: 10px;

    .dot-container {
        position: relative;
    }
}

.dot-description {
    position: absolute;

    // background-color: rgba(255, 255, 255, 0.8);
    width: @dot-container-diameter + @dot-border * 2;
    height: @dot-container-diameter + @dot-border * 2;
    border-radius: 50%;

    display: flex;
    justify-content: center;
    align-items: center;

    text-align: center;
    font-size: .6em;

    opacity: 0;
    transition: opacity 0.2s;
}

.dot-description {
    &:hover, &.interactivated {
        opacity: 1;
    }
}
.accessed-on {
    .access-highlighted {
        .dot-description {
            opacity: 1;
        }
    }
}

.dot-key {
    padding-top: 5px;
    text-align: center;
    font-size: 0.75em;
    transition: box-shadow 0.2s;
    cursor: pointer;

    .text-span {
        user-select: none;
    }

    .anchor-block {
        text-shadow:
        -@text-shadow-offset -@text-shadow-offset @text-shadow-blur @odd-verse-colour,
        @text-shadow-offset -@text-shadow-offset @text-shadow-blur @odd-verse-colour,
        -@text-shadow-offset @text-shadow-offset @text-shadow-blur @odd-verse-colour,
        @text-shadow-offset @text-shadow-offset @text-shadow-blur @odd-verse-colour;
    }
}

.dot {
    &:not(:last-child) {
        margin-right: 1px;
    }
}

.dot:not(.button), .dot .button-icon {
    border: @dot-border solid #aaa;
    border-radius: 50%;
    transition: background-color 0.15s;

    // TODO: Key styling.
    &.songwriting { background-color: @songwriting-dot-colour; }
    &.narrative { background-color: @narrative-dot-colour; }
    &.pun { background-color: @pun-dot-colour; }
    &.reference { background-color: @reference-dot-colour; }
    &.backstory { background-color: @backstory-dot-colour; }
    &.observation { background-color: @observation-dot-colour; }
    &.portal { background-color: @portal-dot-colour; }
    &.afterword { background-color: @afterword-dot-colour; }
}

.dots-section {
    .dot.deselected {
        .button-icon { background-color: lightGray; }
    }
}

.dots-stanza {
    .dot:not(.enabled) {
        .button-icon { background-color: lightGray; }
    }
}

.phone-width {
    .dots-subfield {
        .dot-diameter-mixin(@dot-container-phone-diameter, 0);

        box-shadow: -1px 1px 4px 4px @box-shadow-colour;

        .dots-block {
            // Phone will have four dots per row.
            width: 4 * (@dot-container-phone-diameter + 2 * @dot-container-phone-padding + 3 * @dot-border);
        }

        .dot-container {
            padding: @dot-container-phone-padding;
        }

        .dot-description {
            width: @dot-container-phone-diameter + @dot-border * 2;
            height: @dot-container-phone-diameter + @dot-border * 2;
        }
    }
}
