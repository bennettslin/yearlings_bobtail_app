@overview-toggle-width: 100px;
@overview-toggle-height: 150px;

@overview-subfield-margin: 5px;
@overview-popup-content-wrapper-padding: 15px;

@overview-toggle-laptop-width: @overview-toggle-width * 2 / 3;
@overview-toggle-laptop-height: @overview-toggle-height * 2 / 3;

@overview-toggle-tablet-width: @overview-toggle-width / 2;
@overview-toggle-tablet-height: @overview-toggle-height / 2;

@overview-toggle-phone-width: @overview-toggle-width / 3;
@overview-toggle-phone-height: @overview-toggle-height / 3;

@toggle-animation-duration: 0.9s;

// In main field.
.overview-subfield {
    position: absolute;

    // Ensure overview is below lyrics.
    z-index: 0;

    // This is necessary to avoid right scrollbar in phone width.
    width: ~"calc(100% - @{overview-subfield-margin} * 2)";
    height: ~"calc(100% - @{overview-subfield-margin} * 2)";

    margin: @overview-subfield-margin;
    display: flex;
}


// FIXME: It would be ideal for only the overview toggle to animate left, while the song speech bubble stays put. Because ideally it should be the same speech bubble for both logue and song, that just moves to a new position.
// In main field.
.overview-logue-subfield {
    position: absolute;

    .overview {
        &.popup-transition-group {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: @overview-subfield-margin;
        }

        &.popup-content-wrapper {
            position: relative;
        }
    }
}

.is-song {
    .overview {
        &.popup-content-wrapper {
            // Space for speech bubble arrow. Overridden in phone width.
            margin-left: 25px;
        }
    }
}

// Toggle container.
.overview-toggle-section {
    position: relative;
    height: 100%;
    width: @overview-toggle-width;

    // Ensure toggle button is above popup container.
    z-index: 1;

    border: 1px solid orange;
}

.overview-toggle-button {
    position: absolute;
    width: 100%;
    height: @overview-toggle-height;

    // FIXME: Positioning works, but animation doesn't work?!
    .transition(right @toggle-animation-duration ease);
    right: 0;

    // Temporary.
    background-color: #88d;
}

// Hidden to left when is logue.
.is-logue {
    .overview-toggle-button:not(.in-popup) {
        right: 100%;
    }
}

// Popup container.
.overview-popup-container {
    position: relative;
    flex-grow: 1;

    border: 1px solid green;
}

.overview {
    &.popup-transition-group {
        position: absolute;
        width: 100%;
        height: 100%;
    }

    &.popup-content-wrapper {
        width: 75%;
        min-width: 200px;
        max-width: 450px;
        border-radius: 25px;
        padding: @overview-popup-content-wrapper-padding;

        background-color: white;
    }
}

// Responsive rules.
.monitor-width, .laptop-width {

    .overview-logue-subfield {
        right: 0;
        width: 50%;
        height: 100%;
    }

    // Overview is at the top in desktop.
    .overview-toggle-button, .overview.popup-content-wrapper {
        top: 0;
    }

    &.laptop-width {

        .overview-toggle-section {
            width: @overview-toggle-laptop-width;
        }

        .overview-toggle-button {
            height: @overview-toggle-laptop-height;
        }
    }
}

.tablet-width, .mini-width, .phone-width {

    // Hidden to left when lyric expanded.
    .lyric-expanded {
        .overview-toggle-button:not(.in-popup) {
            right: 100%;
        }
    }

    .overview-logue-subfield {
        width: 100%;
        height: 50%;
        bottom: 0;
    }

    // Overview is at the bottom in mobile.
    .overview-toggle-button, .overview.popup-content-wrapper {
        bottom: 0;
    }

    .overview-toggle-section {
        width: @overview-toggle-tablet-width;
    }

    .overview-toggle-button {
        height: @overview-toggle-tablet-height;
    }

    &.phone-width {
        // Hidden to left when overview is shown.
        .overview-shown {
            .overview-toggle-button:not(.in-popup) {
                right: 100%;
            }
        }

        .overview-subfield {
            flex-direction: column-reverse;

            .overview-popup-container {
                position: absolute;
                width: 100%;
                height: 100%;
            }
        }

        .overview-toggle-section {
            width: @overview-toggle-phone-width;
            height: @overview-toggle-phone-height;
        }

        .overview-toggle-button {
            height: @overview-toggle-phone-height;
        }

        .overview-toggle-button, .overview.popup-content-wrapper {
            min-width: 100%;
        }

        .is-song {
            .overview.popup-content-wrapper {
                margin-left: 0;
            }
        }
    }
}
