/************
 * CAROUSEL *
 ************/

.dom-manager.narrative .carousel-annotation.narrative,
.dom-manager.backstory .carousel-annotation.backstory,
.dom-manager.observation .carousel-annotation.observation,
.dom-manager.pun .carousel-annotation.pun,
.dom-manager.reference .carousel-annotation.reference,
.dom-manager.songwriting .carousel-annotation.songwriting,
.dom-manager.portal .carousel-annotation.portal,
.dom-manager.afterword .carousel-annotation.afterword {

    // min-width: @annotation-card-width + @carousel-annotation-padding * 2 + @annotation-section-padding * 2;
    min-width: @annotation-card-width + @annotation-card-padding * 2 + @carousel-annotation-padding * 2 + @annotation-section-padding * 2;

    .annotation-title-block {
        max-height: 2em; // Arbitrary value that's larger than its max height.
        min-height: @app-small-icon-diameter;
        padding: @annotation-section-padding 0;
    }
}

.dom-manager.mini-width.narrative .carousel-annotation.narrative,
.dom-manager.mini-width.backstory .carousel-annotation.backstory,
.dom-manager.mini-width.observation .carousel-annotation.observation,
.dom-manager.mini-width.pun .carousel-annotation.pun,
.dom-manager.mini-width.reference .carousel-annotation.reference,
.dom-manager.mini-width.songwriting .carousel-annotation.songwriting,
.dom-manager.mini-width.portal .carousel-annotation.portal,
.dom-manager.mini-width.afterword .carousel-annotation.afterword {

    // min-width: @annotation-card-width + @carousel-annotation-padding * 2 + @annotation-section-padding * 2;
    min-width: @annotation-card-mini-width + @annotation-card-padding * 2 + @carousel-annotation-padding * 2 + @annotation-section-padding * 2;
}

.dom-manager.narrative .annotation-card.narrative,
.dom-manager.backstory .annotation-card.backstory,
.dom-manager.observation .annotation-card.observation,
.dom-manager.pun .annotation-card.pun,
.dom-manager.reference .annotation-card.reference,
.dom-manager.songwriting .annotation-card.songwriting,
.dom-manager.portal .annotation-card.portal,
.dom-manager.afterword .annotation-card.afterword {

    min-height: @annotation-dot-diameter;
    max-height: 500px; // Arbitrary large number.
    padding: @annotation-card-padding;
    opacity: 1;
    box-shadow: 0 1px 1px 1px @box-shadow-colour;

    &:not(:last-child) {
        margin-bottom: @annotation-section-padding;
    }
}

/***************
 * DOT STANZAS *
 ***************/

.dom-manager.narrative .dot-stanza.narrative,
.dom-manager.backstory .dot-stanza.backstory,
.dom-manager.observation .dot-stanza.observation,
.dom-manager.pun .dot-stanza.pun,
.dom-manager.reference .dot-stanza.reference,
.dom-manager.songwriting .dot-stanza.songwriting,
.dom-manager.portal .dot-stanza.portal,
.dom-manager.afterword .dot-stanza.afterword {

    max-width: 720px;
    margin-top: @lyric-unit-margin;

    .button {
        width: @app-icon-diameter;
        height: @app-icon-diameter;
    }

    &:not(:first-child) {
        margin-left: @stanza-block-margin;
    }
}

/********
 * DOTS *
 ********/

.dom-manager.narrative .animated-background.narrative,
.dom-manager.backstory .animated-background.backstory,
.dom-manager.observation .animated-background.observation,
.dom-manager.pun .animated-background.pun,
.dom-manager.reference .animated-background.reference,
.dom-manager.songwriting .animated-background.songwriting,
.dom-manager.portal .animated-background.portal,
.dom-manager.afterword .animated-background.afterword {

    transform: scale(1);
    border: @dot-border solid @dot-border-colour;

    &:not(:last-child) {
        margin-right: 1px;
    }

    &.in-lyric {
        width: @lyric-anchor-dot-diameter;
        height: @lyric-anchor-dot-diameter;
    }

    &.in-card {
        width: @annotation-dot-diameter;
        height: @annotation-dot-diameter;
    }
}

.dom-manager.narrative .text-anchor-block .animated-background.narrative,
.dom-manager.backstory .text-anchor-block .animated-background.backstory,
.dom-manager.observation .text-anchor-block .animated-background.observation,
.dom-manager.pun .text-anchor-block .animated-background.pun,
.dom-manager.reference .text-anchor-block .animated-background.reference,
.dom-manager.songwriting .text-anchor-block .animated-background.songwriting,
.dom-manager.portal .text-anchor-block .animated-background.portal,
.dom-manager.afterword .text-anchor-block .animated-background.afterword {
    border: @dot-border solid @lyric-underline-enabled-colour;
}

.dom-manager.narrative .text-anchor-block:hover .animated-background.narrative,
.dom-manager.backstory .text-anchor-block:hover .animated-background.backstory,
.dom-manager.observation .text-anchor-block:hover .animated-background.observation,
.dom-manager.pun .text-anchor-block:hover .animated-background.pun,
.dom-manager.reference .text-anchor-block:hover .animated-background.reference,
.dom-manager.songwriting .text-anchor-block:hover .animated-background.songwriting,
.dom-manager.portal .text-anchor-block:hover .animated-background.portal,
.dom-manager.afterword .text-anchor-block:hover .animated-background.afterword {
    animation: bounceHover @animation-slow;
}

.dom-manager.narrative .text-anchor-block:active .animated-background.narrative,
.dom-manager.backstory .text-anchor-block:active .animated-background.backstory,
.dom-manager.observation .text-anchor-block:active .animated-background.observation,
.dom-manager.pun .text-anchor-block:active .animated-background.pun,
.dom-manager.reference .text-anchor-block:active .animated-background.reference,
.dom-manager.songwriting .text-anchor-block:active .animated-background.songwriting,
.dom-manager.portal .text-anchor-block:active .animated-background.portal,
.dom-manager.afterword .text-anchor-block:active .animated-background.afterword {
    transform: scale(0.75);
}

/***************
 * DOT ANCHORS *
 ***************/

// This is the one source of truth for how dot anchors are ordered!
.dom-manager.portal .dot-anchor:not(.selected) .animated-background.portal {
    background-color: @portal-dot-colour;
}
.dom-manager.observation .dot-anchor:not(.selected) .animated-background.observation {
    background-color: @observation-dot-colour;
}
.dom-manager.backstory .dot-anchor:not(.selected) .animated-background.backstory {
    background-color: @backstory-dot-colour;
}
.dom-manager.reference .dot-anchor:not(.selected) .animated-background.reference {
    background-color: @reference-dot-colour;
}
.dom-manager.pun .dot-anchor:not(.selected) .animated-background.pun {
    background-color: @pun-dot-colour;
}
.dom-manager.narrative .dot-anchor:not(.selected) .animated-background.narrative {
    background-color: @narrative-dot-colour;
}
.dom-manager.songwriting .dot-anchor:not(.selected) .animated-background.songwriting {
    background-color: @songwriting-dot-colour;
}
.dom-manager.afterword .dot-anchor:not(.selected) .animated-background.afterword {
    background-color: @afterword-dot-colour;
}

/*****************
 * ANCHOR BLOCKS *
 *****************/

.dom-manager.narrative .anchor-block.narrative,
.dom-manager.backstory .anchor-block.backstory,
.dom-manager.observation .anchor-block.observation,
.dom-manager.pun .anchor-block.pun,
.dom-manager.reference .anchor-block.reference,
.dom-manager.songwriting .anchor-block.songwriting,
.dom-manager.portal .anchor-block.portal,
.dom-manager.afterword .anchor-block.afterword,

.anchor-block.in-dots-section {

    // Default colour.
    .underline-bar {
        background-color: @lyric-underline-disabled-colour;
    }

    &.anchor-block:not(.selected) {
        cursor: pointer;

        .text-span {
            color: @lyric-link-colour;
        }

        &:hover {
            .text-span {
                color: @lyric-hover-colour;
            }

            .underline-bar {
                animation: bounceHover @animation-default;
            }
        }

        &:active {
            .text-span {
                color: @lyric-active-colour;
            }

            .underline-bar {
                transform: scale(0.9);
            }
        }

        .underline-bar {
            background-color: @lyric-underline-enabled-colour;
        }
    }

    &.selected {
        .text-span {
            color: @selected-annotation-text-colour;
        }

        .underline-bar {
            background-color: @selected-annotation-underline-colour;
        }

        .animated-background {
            border: @dot-border solid @selected-annotation-underline-colour;
            background-color: @deselected-dot-colour;
        }
    }
}
